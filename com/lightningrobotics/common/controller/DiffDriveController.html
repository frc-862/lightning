<!DOCTYPE HTML>
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>DiffDriveController (lightning API)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery/jquery-ui.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip/dist/jszip.min.js"></script>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils.min.js"></script>
<!--[if IE]>
<script type="text/javascript" src="../../../../jquery/jszip-utils/dist/jszip-utils-ie.min.js"></script>
<![endif]-->
<script type="text/javascript" src="../../../../jquery/jquery-3.5.1.js"></script>
<script type="text/javascript" src="../../../../jquery/jquery-ui.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="DiffDriveController (lightning API)";
        }
    }
    catch(err) {
    }
//-->
var data = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
var pathtoroot = "../../../../";
var useModuleDirectories = true;
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<header role="banner">
<nav role="navigation">
<div class="fixedNav">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a id="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<ul class="navListSearch">
<li><label for="search">SEARCH:</label>
<input type="text" id="search" value="search" disabled="disabled">
<input type="reset" id="reset" value="reset" disabled="disabled">
</li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
</div>
<div class="navPadding">&nbsp;</div>
<script type="text/javascript"><!--
$('.navPadding').css('padding-top', $('.fixedNav').css("height"));
//-->
</script>
</nav>
</header>
<!-- ======== START OF CLASS DATA ======== -->
<main role="main">
<div class="header">
<div class="subTitle"><span class="packageLabelInType">Package</span>&nbsp;<a href="package-summary.html">com.lightningrobotics.common.controller</a></div>
<h2 title="Class DiffDriveController" class="title">Class DiffDriveController</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.lightningrobotics.common.controller.DiffDriveController</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<pre>public class <span class="typeNameLabel">DiffDriveController</span>
extends java.lang.Object</pre>
<div class="block">Ramsete is a nonlinear time-varying feedback controller for unicycle models that drives the model
 to a desired pose along a two-dimensional trajectory. Why would we need a nonlinear control law
 in addition to the linear ones we have used so far like PID? If we use the original approach with
 PID controllers for left and right position and velocity states, the controllers only deal with
 the local pose. If the robot deviates from the path, there is no way for the controllers to
 correct and the robot may not reach the desired global pose. This is due to multiple endpoints
 existing for the robot which have the same encoder path arc lengths.

 <p>Instead of using wheel path arc lengths (which are in the robot's local coordinate frame),
 nonlinear controllers like pure pursuit and Ramsete use global pose. The controller uses this
 extra information to guide a linear reference tracker like the PID controllers back in by
 adjusting the references of the PID controllers.

 <p>The paper "Control of Wheeled Mobile Robots: An Experimental Overview" describes a nonlinear
 controller for a wheeled vehicle with unicycle-like kinematics; a global pose consisting of x, y,
 and theta; and a desired pose consisting of x_d, y_d, and theta_d. We call it Ramsete because
 that's the acronym for the title of the book it came from in Italian ("Robotica Articolata e
 Mobile per i SErvizi e le TEcnologie").

 <p>See <a href="https://file.tavsys.net/control/controls-engineering-in-frc.pdf">Controls
 Engineering in the FIRST Robotics Competition</a> section on Ramsete unicycle controller for a
 derivation and analysis.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Constructor</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr class="altColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E()">DiffDriveController</a></span>()</code></th>
<td class="colLast">
<div class="block">Construct a Ramsete unicycle controller.</div>
</td>
</tr>
<tr class="rowColor">
<th class="colConstructorName" scope="row"><code><span class="memberNameLink"><a href="#%3Cinit%3E(double,double)">DiffDriveController</a></span>&#8203;(double&nbsp;b,
                   double&nbsp;zeta)</code></th>
<td class="colLast">
<div class="block">Construct a Ramsete unicycle controller.</div>
</td>
</tr>
</table>
</li>
</ul>
</section>
<!-- ========== METHOD SUMMARY =========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colSecond" scope="col">Method</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#atReference()">atReference</a></span>()</code></th>
<td class="colLast">
<div class="block">Returns true if the pose error is within tolerance of the reference.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../geometry/kinematics/DrivetrainSpeed.html" title="class in com.lightningrobotics.common.geometry.kinematics">DrivetrainSpeed</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculate(edu.wpi.first.math.geometry.Pose2d,com.lightningrobotics.common.auto.trajectory.TrajectoryState)">calculate</a></span>&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;currentPose,
         <a href="../auto/trajectory/TrajectoryState.html" title="class in com.lightningrobotics.common.auto.trajectory">TrajectoryState</a>&nbsp;desiredState)</code></th>
<td class="colLast">
<div class="block">Returns the next output of the Ramsete controller.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../geometry/kinematics/DrivetrainSpeed.html" title="class in com.lightningrobotics.common.geometry.kinematics">DrivetrainSpeed</a></code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#calculate(edu.wpi.first.math.geometry.Pose2d,edu.wpi.first.math.geometry.Pose2d,double,double)">calculate</a></span>&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;currentPose,
         edu.wpi.first.math.geometry.Pose2d&nbsp;poseRef,
         double&nbsp;linearVelocityRefMeters,
         double&nbsp;angularVelocityRefRadiansPerSecond)</code></th>
<td class="colLast">
<div class="block">Returns the next output of the Ramsete controller.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setEnabled(boolean)">setEnabled</a></span>&#8203;(boolean&nbsp;enabled)</code></th>
<td class="colLast">
<div class="block">Enables and disables the controller for troubleshooting purposes.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<th class="colSecond" scope="row"><code><span class="memberNameLink"><a href="#setTolerance(edu.wpi.first.math.geometry.Pose2d)">setTolerance</a></span>&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;poseTolerance)</code></th>
<td class="colLast">
<div class="block">Sets the pose error which is considered tolerable for use with atReference().</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a id="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a id="&lt;init&gt;(double,double)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DiffDriveController</h4>
<pre>public&nbsp;DiffDriveController&#8203;(double&nbsp;b,
                           double&nbsp;zeta)</pre>
<div class="block">Construct a Ramsete unicycle controller.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>b</code> - Tuning parameter (b &gt; 0 rad²/m²) for which larger values make convergence more
     aggressive like a proportional term.</dd>
<dd><code>zeta</code> - Tuning parameter (0 rad⁻¹ &lt; zeta &lt; 1 rad⁻¹) for which larger values provide
     more damping in response.</dd>
</dl>
</li>
</ul>
<a id="&lt;init&gt;()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DiffDriveController</h4>
<pre>public&nbsp;DiffDriveController()</pre>
<div class="block">Construct a Ramsete unicycle controller. The default arguments for b and zeta of 2.0 rad²/m²
 and 0.7 rad⁻¹ have been well-tested to produce desirable results.</div>
</li>
</ul>
</li>
</ul>
</section>
<!-- ============ METHOD DETAIL ========== -->
<section role="region">
<ul class="blockList">
<li class="blockList"><a id="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a id="atReference()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>atReference</h4>
<pre class="methodSignature">public&nbsp;boolean&nbsp;atReference()</pre>
<div class="block">Returns true if the pose error is within tolerance of the reference.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>True if the pose error is within tolerance of the reference.</dd>
</dl>
</li>
</ul>
<a id="setTolerance(edu.wpi.first.math.geometry.Pose2d)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setTolerance</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setTolerance&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;poseTolerance)</pre>
<div class="block">Sets the pose error which is considered tolerable for use with atReference().</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>poseTolerance</code> - Pose error which is tolerable.</dd>
</dl>
</li>
</ul>
<a id="calculate(edu.wpi.first.math.geometry.Pose2d,edu.wpi.first.math.geometry.Pose2d,double,double)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculate</h4>
<pre class="methodSignature">public&nbsp;<a href="../geometry/kinematics/DrivetrainSpeed.html" title="class in com.lightningrobotics.common.geometry.kinematics">DrivetrainSpeed</a>&nbsp;calculate&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;currentPose,
                                 edu.wpi.first.math.geometry.Pose2d&nbsp;poseRef,
                                 double&nbsp;linearVelocityRefMeters,
                                 double&nbsp;angularVelocityRefRadiansPerSecond)</pre>
<div class="block">Returns the next output of the Ramsete controller.

 <p>The reference pose, linear velocity, and angular velocity should come from a drivetrain
 trajectory.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>currentPose</code> - The current pose.</dd>
<dd><code>poseRef</code> - The desired pose.</dd>
<dd><code>linearVelocityRefMeters</code> - The desired linear velocity in meters per second.</dd>
<dd><code>angularVelocityRefRadiansPerSecond</code> - The desired angular velocity in radians per second.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The next controller output.</dd>
</dl>
</li>
</ul>
<a id="calculate(edu.wpi.first.math.geometry.Pose2d,com.lightningrobotics.common.auto.trajectory.TrajectoryState)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>calculate</h4>
<pre class="methodSignature">public&nbsp;<a href="../geometry/kinematics/DrivetrainSpeed.html" title="class in com.lightningrobotics.common.geometry.kinematics">DrivetrainSpeed</a>&nbsp;calculate&#8203;(edu.wpi.first.math.geometry.Pose2d&nbsp;currentPose,
                                 <a href="../auto/trajectory/TrajectoryState.html" title="class in com.lightningrobotics.common.auto.trajectory">TrajectoryState</a>&nbsp;desiredState)</pre>
<div class="block">Returns the next output of the Ramsete controller.

 <p>The reference pose, linear velocity, and angular velocity should come from a drivetrain
 trajectory.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>currentPose</code> - The current pose.</dd>
<dd><code>desiredState</code> - The desired pose, linear velocity, and angular velocity from a trajectory.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The next controller output.</dd>
</dl>
</li>
</ul>
<a id="setEnabled(boolean)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>setEnabled</h4>
<pre class="methodSignature">public&nbsp;void&nbsp;setEnabled&#8203;(boolean&nbsp;enabled)</pre>
<div class="block">Enables and disables the controller for troubleshooting purposes.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>enabled</code> - If the controller is enabled or not.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</section>
</li>
</ul>
</div>
</div>
</main>
<!-- ========= END OF CLASS DATA ========= -->
<footer role="contentinfo">
<nav role="navigation">
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a id="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a id="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a id="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</nav>
</footer>
</body>
</html>
